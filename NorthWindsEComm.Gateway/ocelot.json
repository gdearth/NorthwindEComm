{
  "Routes": [
    {
      "UpstreamHttpMethod": ["GET", "POST"],
      "UpstreamPathTemplate": "/api/{version}/products",
      "DownstreamPathTemplate": "/{version}/products",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [
        {
          "Host": "products-api"
        }
      ],
      "Priority": 1,
      "Key": "allProducts"
    },
    {
      "UpstreamHttpMethod": ["GET"],
      "UpstreamPathTemplate": "/api/{version}/products/{productId}",
      "DownstreamPathTemplate": "/{version}/products/{productId}",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [
        {
          "Host": "products-api"
        }
      ],
      "Priority": 0,
      "Key": "product"
    },
    {
      "UpstreamHttpMethod": ["GET", "POST"],
      "UpstreamPathTemplate": "/api/{version}/suppliers",
      "DownstreamPathTemplate": "/{version}/suppliers",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [
        {
          "Host": "suppliers-api"
        }
      ],
      "Priority": 1,
      "Key": "allSuppliers"
    },
    {
      "UpstreamHttpMethod": ["GET", "POST"],
      "UpstreamPathTemplate": "/api/{version}/suppliers/{supplierId}",
      "DownstreamPathTemplate": "/{version}/suppliers/{supplierId}",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [
        {
          "Host": "suppliers-api"
        }
      ],
      "Key": "supplier",
      "Priority": 0
    },
    {
      "UpstreamHttpMethod": ["GET"],
      "UpstreamPathTemplate": "/api/{version}/categories/{categoryId}/products",
      "DownstreamPathTemplate": "/{version}/products?categoryId={categoryId}",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [
        {
          "Host": "products-api"
        }
      ],
      "Priority": 2,
      "Key": "productsByCategoryId"
    },
    {
      "UpstreamHttpMethod": ["GET", "POST"],
      "UpstreamPathTemplate": "/api/{version}/categories",
      "DownstreamPathTemplate": "/{version}/categories",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [
        {
          "Host": "categories-api"
        }
      ],
      "Priority": 1,
      "Key": "allCategories"
    },
    {
      "UpstreamHttpMethod": ["GET"],
      "UpstreamPathTemplate": "/api/{version}/categories/{categoryId}",
      "DownstreamPathTemplate": "/{version}/categories/{categoryId}",
      "DownstreamScheme": "http",
      "DownstreamHostAndPorts": [
        {
          "Host": "categories-api"
        }
      ],
      "Priority": 0,
      "Key": "category"
    }
  ],
  "Aggregates": [
    {
      "UpstreamPathTemplate": "/bff/{version}/fillCache",
      "UpstreamHttpMethod": [ "Get" ],
      "RouteKeys": [ "allProducts", "allSuppliers", "allCategories" ]
    },
    {
      "UpstreamPathTemplate": "/bff/{version}/products/{productId}",
      "UpstreamHttpMethod": [ "Get" ],
      "RouteKeys": [ "product", "supplier", "category" ],
      "RouteKeysConfig" : [
        {
          "RouteKey" : "supplier",
          "JsonPath": "$.supplierId",
          "Parameter": "supplierId"
        },
        {
          "RouteKey" : "category",
          "JsonPath": "$.categoryId",
          "Parameter": "categoryId"
        }
      ]
    },
    {
      "UpstreamPathTemplate": "/bff/{version}/categories/{categoryId}",
      "UpstreamHttpMethod": [ "Get" ],
      "RouteKeys": [ "productsByCategoryId", "category" ]
    }
  ],
  "GlobalConfiguration": {
    "BaseUrl": "http://localhost:5075"
  }
}